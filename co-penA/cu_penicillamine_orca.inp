# ==============================================================================
# ORCA INPUT FILE FOR Cu-PENICILLAMINE COMPLEX
# Based on Nkungli & Ghogomu (2017) methodology
# ==============================================================================

# ------------------------------------------------------------------------------
# Job 1: Geometry Optimization with BP86-D3(BJ)
# ------------------------------------------------------------------------------
! BP86 D3BJ def2-SVP def2-SVP/J RIJCOSX
! OPT DEFGRID2 TightSCF
! PAL4  # Use 4 CPU cores

%maxcore 2000  # MB per core

%scf
  MaxIter 200
  ConvForced true
end

%geom
  MaxIter 150
  Calc_Hess true
  Recalc_Hess 15
  Trust 0.3
  MaxStep 0.3
end

* xyz 0 2  # Charge=0, Multiplicity=2 (doublet for Cu(II))
C -6.48761 -4.97242 1.48230
C -7.93727 -4.98602 0.94199
H -8.63742 -5.45562 1.66343
H -7.98292 -5.57699 -0.00369
H -8.30189 -3.96377 0.71400
C -6.08494 -6.43841 1.75677
H -6.79668 -6.90212 2.47714
H -5.07090 -6.50674 2.20062
H -6.10603 -7.04331 0.82404
C -5.57115 -4.30739 0.40727
C -4.09466 -4.36089 0.79896
O -3.21209 -4.93698 -0.06507
H -2.26810 -4.96945 0.14337
O -3.69987 -3.91890 1.84571
N -6.01231 -2.91451 0.17743
H -5.67484 -4.85544 -0.55208
S -6.34630 -4.02050 3.07487
C -5.52051 0.92555 2.46932
C -5.36110 2.35886 1.89397
H -5.77444 2.43361 0.86449
H -4.29831 2.67674 1.86222
H -5.90928 3.09786 2.52328
C -4.92834 0.91160 3.88738
H -3.85195 1.19773 3.83542
H -4.99420 -0.10280 4.32871
H -5.41240 1.64820 4.55757
C -7.05510 0.54715 2.36663
C -7.93117 1.41086 3.25636
O -7.82656 1.34945 4.47366
N -7.33659 -0.86298 2.65689
H -7.35549 0.71830 1.30860
O -8.84776 2.23713 2.71054
H -9.41545 2.79163 3.26665
Cu -5.94420 -2.02580 1.91951
S -4.47973 -0.26743 1.51396
H -8.30389 -1.11923 2.35558
H -5.35116 -2.45939 -0.49326
*

# ------------------------------------------------------------------------------
# Save optimized geometry
# ------------------------------------------------------------------------------
%output
  Print[P_Coords] 1
  Print[P_AtCharges_M] 1
end


# ==============================================================================
# ==============================================================================

$new_job

# ------------------------------------------------------------------------------
# Job 2: Single-Point Energy with B3LYP-D3(BJ)/def2-TZVP
# Based on optimized geometry from Job 1
# ------------------------------------------------------------------------------
! B3LYP D3BJ def2-TZVP def2-TZVP/J RIJCOSX
! TightSCF DEFGRID3
! PAL4

%maxcore 2000

%scf
  MaxIter 200
end

# Molecular Orbitals and Population Analysis
%output
  Print[P_Basis] 2
  Print[P_MOs] 1
  Print[P_AtCharges_M] 1  # Mulliken charges
  Print[P_AtCharges_L] 1  # Loewdin charges
  Print[P_Hirshfeld] 1     # Hirshfeld charges
end

# Generate cube files for visualization
%plots
  dim1 80
  dim2 80  
  dim3 80
  Format Cube
  # Electron density
  ElDens("density.cube");
  # Molecular orbitals (HOMO-2 to LUMO+2)
  MO("homo-2.cube", 108, 0);  # Adjust orbital numbers
  MO("homo-1.cube", 109, 0);
  MO("homo.cube", 110, 0);
  MO("lumo.cube", 111, 0);
  MO("lumo+1.cube", 112, 0);
end

# Molecular Electrostatic Potential
%elprop
  Polar 1  # Polarizability
  Dipole true
end

* xyzfile 0 2 cu_penicillamine_opt.xyz  # Use optimized geometry from Job 1

# ==============================================================================
# ==============================================================================

$new_job

# ------------------------------------------------------------------------------
# Job 3: Fukui Function Calculation (N+1 system - Anion)
# ------------------------------------------------------------------------------
! B3LYP D3BJ def2-TZVP def2-TZVP/J RIJCOSX
! TightSCF
! PAL4

%maxcore 2000

%output
  Print[P_AtCharges_M] 1  # Mulliken charges for Fukui functions
  Print[P_Hirshfeld] 1
end

* xyzfile -1 1 cu_penicillamine_opt.xyz  # Charge=-1, Singlet

# ==============================================================================
# ==============================================================================

$new_job

# ------------------------------------------------------------------------------
# Job 4: Fukui Function Calculation (N-1 system - Cation)
# ------------------------------------------------------------------------------
! B3LYP D3BJ def2-TZVP def2-TZVP/J RIJCOSX
! TightSCF
! PAL4

%maxcore 2000

%output
  Print[P_AtCharges_M] 1  # Mulliken charges for Fukui functions
  Print[P_Hirshfeld] 1
end

* xyzfile 1 3 cu_penicillamine_opt.xyz  # Charge=+1, Triplet

# ==============================================================================
# NOTES:
# ==============================================================================
#
# 1. This input performs 4 sequential calculations:
#    - Geometry optimization (BP86-D3BJ/def2-SVP)
#    - High-level single-point (B3LYP-D3BJ/def2-TZVP)
#    - Anion calculation for Fukui f+ function
#    - Cation calculation for Fukui f- function
#
# 2. To run: orca cu_penicillamine.inp > cu_penicillamine.out
#
# 3. Output files:
#    - cu_penicillamine.xyz (optimized geometry)
#    - density.cube (electron density)
#    - homo.cube, lumo.cube (molecular orbitals)
#    - *.gbw (wavefunction files)
#    - *.out (main output with energies and properties)
#
# 4. For Fukui function analysis, compare charges from Jobs 2, 3, 4:
#    f+ = q(N+1) - q(N)     # Nucleophilic attack
#    f- = q(N) - q(N-1)     # Electrophilic attack
#    Î”f = f+ - f-           # Dual descriptor
#
# 5. Visualization:
#    - Use Avogadro, VMD, or ChimeraX for .cube files
#    - Use orca_plot to extract more data
#
# ==============================================================================
